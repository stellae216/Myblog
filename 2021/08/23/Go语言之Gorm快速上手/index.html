

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/Myblog/img/favicon.png">
  <link rel="icon" href="/Myblog/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="Simple, so charming!">
  <meta name="author" content="stellae">
  <meta name="keywords" content="">
  
  <title>Go语言之Gorm快速上手 - stellae&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/Myblog/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/Myblog/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"stellae.gitee.io","root":"/Myblog/","version":"1.8.10","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/Myblog/js/utils.js" ></script>
  <script  src="/Myblog/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 40vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/Myblog/">&nbsp;<strong>stellae's blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/Myblog/img/WtwSsqwYlA0.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Go语言之Gorm快速上手">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      stellae
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-08-23 08:38" pubdate>
        2021年8月23日 早上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2.2k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      43
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Go语言之Gorm快速上手</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：6 个月前
                
              </p>
            
            <div class="markdown-body">
              <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>gorm是一个使用Go语言编写的ORM框架。配套齐全的<a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/index.html">中文官方文档</a>，对开发者友好，支持主流数据库，并且拥有以下特性。</p>
<ul>
<li>全功能 ORM</li>
<li>关联 (Has One，Has Many，Belongs To，Many To Many，多态，单表继承)</li>
<li>Create，Save，Update，Delete，Find 中钩子方法</li>
<li>支持 <code>Preload</code>、<code>Joins</code> 的预加载</li>
<li>事务，嵌套事务，Save Point，Rollback To Saved Point</li>
<li>Context、预编译模式、DryRun 模式</li>
<li>批量插入，FindInBatches，Find/Create with Map，使用 SQL 表达式、Context Valuer 进行 CRUD</li>
<li>SQL 构建器，Upsert，数据库锁，Optimizer/Index/Comment Hint，命名参数，子查询</li>
<li>复合主键，索引，约束</li>
<li>Auto Migration</li>
<li>自定义 Logger</li>
<li>灵活的可扩展插件 API：Database Resolver（多数据库，读写分离）、Prometheus…</li>
<li>每个特性都经过了测试的重重考验</li>
<li>开发者友好</li>
</ul>
<h3 id="GORM配置"><a href="#GORM配置" class="headerlink" title="GORM配置"></a>GORM配置</h3><p>安装gorm</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">go</span> get -u gorm.io/gorm<br><span class="hljs-keyword">go</span> get -u gorm.io/driver/postgres<br></code></pre></td></tr></table></figure>

<p>这里是测试的项目结构</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs go">.<br>├── app<br>│   ├── config<br>│   │   └── db.<span class="hljs-keyword">go</span><br>│   ├── db.<span class="hljs-keyword">go</span><br>│   ├── entity<br>│   │   ├── base.<span class="hljs-keyword">go</span><br>│   │   └── member.<span class="hljs-keyword">go</span><br>│   ├── model<br>│   │   ├── base.<span class="hljs-keyword">go</span><br>│   │   └── member.<span class="hljs-keyword">go</span><br>│   ├── router<br>│   │   ├── health.<span class="hljs-keyword">go</span><br>│   │   └── member.<span class="hljs-keyword">go</span><br>│   ├── service<br>│   │   └── member.<span class="hljs-keyword">go</span><br>│   └── utils<br>│       └── function.<span class="hljs-keyword">go</span><br>├── docker-compose.yml<br>├── <span class="hljs-keyword">go</span>.mod<br>├── <span class="hljs-keyword">go</span>.sum<br>└── main.<span class="hljs-keyword">go</span><br></code></pre></td></tr></table></figure>



<h4 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h4><p>app/db.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs go"><br><span class="hljs-keyword">var</span> DB *gorm.DB<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> &#123;<br>	dsn := url.URL&#123;<br>		User:     url.UserPassword(config.DBConfig.UserName, config.DBConfig.Password),<br>		Scheme:   <span class="hljs-string">&quot;postgres&quot;</span>,<br>		Host:     fmt.Sprintf(<span class="hljs-string">&quot;%s:%d&quot;</span>, config.DBConfig.Host, config.DBConfig.Port),<br>		Path:     config.DBConfig.DataBase,<br>		RawQuery: (&amp;url.Values&#123;<span class="hljs-string">&quot;sslmode&quot;</span>: []<span class="hljs-keyword">string</span>&#123;<span class="hljs-string">&quot;disable&quot;</span>&#125;&#125;).Encode(),<br>	&#125;<br>	dbUrl := dsn.String()<br>	dbGorm, err := gorm.Open(postgres.Open(dbUrl), &amp;gorm.Config&#123;<br>		DisableForeignKeyConstraintWhenMigrating: <span class="hljs-literal">true</span>,<br>		Logger:                                   logger.Default.LogMode(logger.Info),<br>		NamingStrategy: schema.NamingStrategy&#123;<br>			<span class="hljs-comment">//TablePrefix: &quot;gorm_&quot;,</span><br>			SingularTable: <span class="hljs-literal">true</span>,<br>			<span class="hljs-comment">//NoLowerCase: true,</span><br>		&#125;,<br>	&#125;)<br>	<span class="hljs-comment">//禁用外键约束</span><br>	<span class="hljs-comment">//在打开连接时设置日志级别为Info</span><br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-built_in">panic</span>(<span class="hljs-string">&quot;failed to connect database&quot;</span>)<br>	&#125;<br>	err = dbGorm.AutoMigrate(&amp;Member&#123;&#125;, &amp;Record&#123;&#125;, &amp;RecordItem&#123;&#125;)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-built_in">panic</span>(<span class="hljs-string">&quot;failed to migrator&quot;</span>)<br>	&#125;<br>	DB = dbGorm<br>&#125;<br><br></code></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>DisableForeignKeyConstraintWhenMigrating - 迁移时是否禁用外键</li>
<li>Logger - 定义数据库日志输出等级(info可以打印执行sql)</li>
<li>TablePrefix - 设置表名前缀</li>
<li>SingularTable - 设置表名是否为单数，默认false</li>
<li>NoLowerCase - 设置表名是否不小写，默认false</li>
</ul>
</blockquote>
<p>main.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> 	_ <span class="hljs-string">&quot;app&quot;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>执行<code>app/db.go</code>中的 <code>init </code> 函数，初始化数据库</p>
</blockquote>
<h4 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h4><p>查看官方文档有<a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/models.html#%E5%AD%97%E6%AE%B5%E6%A0%87%E7%AD%BE">gorm标签</a>的详细使用方式。</p>
<p>app/model/base.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> BaseModel <span class="hljs-keyword">struct</span> &#123;<br>	ID        <span class="hljs-keyword">uint</span>      <span class="hljs-string">`gorm:&quot;primaryKey;comment:ID&quot;`</span><br>	CreatedAt time.Time <span class="hljs-string">`gorm:&quot;column:created_at;default:now();not null;comment:创建时间&quot;`</span><br>	UpdatedAt time.Time <span class="hljs-string">`gorm:&quot;column:updated_at;default:now();not null;autoUpdateTime;comment:修改时间&quot;`</span><br>&#125;<br><br><span class="hljs-keyword">type</span> Record <span class="hljs-keyword">struct</span> &#123;<br>	BaseModel<br>	Note       *<span class="hljs-keyword">string</span>      <span class="hljs-string">`gorm:&quot;column:note;type:text;comment:备注&quot;`</span><br>	Weight     *<span class="hljs-keyword">float32</span>    <span class="hljs-string">`gorm:&quot;column:weight;comment:体重(斤)&quot;`</span><br>	IsWBM      <span class="hljs-keyword">bool</span>        <span class="hljs-string">`gorm:&quot;column:is_wbm;not null;comment:Drink water before meals&quot;`</span><br>	IsRun      <span class="hljs-keyword">bool</span>        <span class="hljs-string">`gorm:&quot;column:is_run;not null;comment:Running&quot;`</span><br>	RecordDate time.Time   <span class="hljs-string">`gorm:&quot;column:record_date;default:now();type:date;uniqueIndex:record_agg_unique_idx;not null;comment:记录日期date&quot;`</span><br>	MemberId   <span class="hljs-keyword">string</span>      <span class="hljs-string">`gorm:&quot;column:member_id;not null;uniqueIndex:record_agg_unique_idx;comment:用户ID&quot;`</span><br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p><code>autoUpdateTime</code> - 更新数据时自动更新此字段时间</p>
</li>
<li><p><code>索引</code> - 使用<code>index</code>和<code>unique</code> 可分别添加<code>索引</code>和<code>唯一索引</code>，索引名称默认定义 ；<code>index</code> , <code>uniqueIndex </code> 指定相同的名字可以创建联合(唯一)索引，创建联合唯一索引时，不要使用<code>unique</code>标签，会继续创建单个唯一索引</p>
</li>
</ul>
</blockquote>
<p>app/model/member.go</p>
<p><strong>非必填参数类型建议使用指针，可以保存<code>nil</code>类型，对应数据库中的<code>null</code></strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//type Tabler interface &#123;</span><br><span class="hljs-comment">//	TableName() string</span><br><span class="hljs-comment">//&#125;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//func (t *Member) TableName() string &#123;</span><br><span class="hljs-comment">//	return &quot;member&quot;</span><br><span class="hljs-comment">//&#125;</span><br><br><span class="hljs-keyword">type</span> Member <span class="hljs-keyword">struct</span> &#123;<br>	BaseModel<br>	Username <span class="hljs-keyword">string</span> <span class="hljs-string">`gorm:&quot;column:username;type:varchar(16);unique;not null;comment:用户名&quot;`</span><br>	Password <span class="hljs-keyword">string</span> <span class="hljs-string">`gorm:&quot;column:password;type:varchar(128);not null;comment:密码&quot;`</span><br>	Phone    *<span class="hljs-keyword">string</span> <span class="hljs-string">`gorm:&quot;column:phone;type:varchar(16);comment:手机号码&quot;`</span><br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p>默认表名：复数小写形式，如果是驼峰改为下划线连接。</p>
</li>
<li><p>自定义表名：可以通过实现<code>Tabler</code>接口来更改，<code>TableName()</code>方法返回值为真正创建的表名。</p>
</li>
<li><p>自定义表名：也可以通过前文提到的<code>schema.NamingStrategy</code>相关参数进行设置。</p>
</li>
</ul>
</blockquote>
<h4 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h4><h5 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;golang.org/x/crypto/bcrypt&quot;</span><br><br><span class="hljs-keyword">var</span> db *gorm.DB = app.DB<br><br><span class="hljs-comment">// 参数类型建议使用指针，不为required时，对应零值为nil，insert db时能够方便转换成null </span><br><span class="hljs-keyword">type</span> MemberPartInfo <span class="hljs-keyword">struct</span> &#123;<br>	Username  *<span class="hljs-keyword">string</span>    <span class="hljs-string">`json:&quot;username&quot; binding:&quot;required&quot;`</span><br>	Password  *<span class="hljs-keyword">string</span>    <span class="hljs-string">`json:&quot;password&quot; binding:&quot;required&quot;`</span><br>	Phone   *<span class="hljs-keyword">string</span>      <span class="hljs-string">`json:&quot;phone&quot;`</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MemberRouter</span><span class="hljs-params">(router *gin.RouterGroup)</span></span> &#123;<br>	r := router.Group(<span class="hljs-string">&quot;/members&quot;</span>)<br>	r.POST(<span class="hljs-string">&quot;/&quot;</span>, addMember)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">addMember</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	<span class="hljs-keyword">var</span> data entity.MemberPartInfo<br>	<span class="hljs-keyword">if</span> err := c.ShouldBindJSON(&amp;data); err != <span class="hljs-literal">nil</span> &#123;<br>		c.JSON(http.StatusBadRequest, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: err.Error()&#125;)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>  <span class="hljs-comment">// 计算密码加盐哈希值，验证用函数bcrypt.CompareHashAndPassword(hashPassword, password)</span><br>	bHash, err := bcrypt.GenerateFromPassword([]<span class="hljs-keyword">byte</span>(*data.Password), bcrypt.DefaultCost)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		c.JSON(http.StatusForbidden, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: err.Error()&#125;)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">var</span> member = Member&#123;Username: *data.Username, Password: <span class="hljs-keyword">string</span>(bHash), Phone: data.Phone&#125;<br>	<span class="hljs-keyword">if</span> err := db.Create(&amp;member).Error; err != <span class="hljs-literal">nil</span> &#123;<br>		c.JSON(http.StatusForbidden, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: err.Error()&#125;)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	c.JSON(http.StatusCreated, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;success&quot;</span>&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>orm接收或传入null值，可以用 <strong>指针</strong> 或 <strong>sql.NullXXX方法</strong>，sql.NullXXX中Valid属性为false时，值为null。实际使用情况来看，个人认为用指针更好，可以参考这篇文章 <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42279809/article/details/107800081">gin框架参数零值json绑定的问题</a></p>
</blockquote>
<h5 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> MemberInfo <span class="hljs-keyword">struct</span> &#123;<br>  ID        *<span class="hljs-keyword">uint</span>      <span class="hljs-string">`json:&quot;id&quot;`</span><br>	CreatedAt *time.Time <span class="hljs-string">`json:&quot;created_at&quot;`</span><br>	UpdatedAt *time.Time <span class="hljs-string">`json:&quot;updated_at&quot;`</span><br>	Username *<span class="hljs-keyword">string</span> <span class="hljs-string">`json:&quot;username&quot; binding:&quot;required&quot;`</span><br>	Password *<span class="hljs-keyword">string</span> <span class="hljs-string">`json:&quot;password&quot; binding:&quot;required&quot;`</span><br>	Phone    *<span class="hljs-keyword">string</span> <span class="hljs-string">`json:&quot;phone&quot;`</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">singleMemberInfo</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	memberID := c.Param(<span class="hljs-string">&quot;memberID&quot;</span>)<br>	<span class="hljs-keyword">var</span> member entity.MemberInfo<br>	db.Model(&amp;Member&#123;&#125;).First(&amp;member, memberID)<br>	c.JSON(http.StatusOK, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;success&quot;</span>, <span class="hljs-string">&quot;member&quot;</span>: member&#125;)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">memberList</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	<span class="hljs-keyword">var</span> members []entity.MemberInfo<br>	db.Model(&amp;Member&#123;&#125;).Order(<span class="hljs-string">&quot;id&quot;</span>).Find(&amp;members)<br>	c.JSON(http.StatusOK, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;ok&quot;</span>, <span class="hljs-string">&quot;data&quot;</span>: members&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>更多高级用法查看<a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/query.html#%E6%A3%80%E7%B4%A2%E5%8D%95%E4%B8%AA%E5%AF%B9%E8%B1%A1">官网</a></p>
<h5 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h5><ul>
<li>update - 更新单个字段</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">updateMemberInfo</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	memberID := c.Param(<span class="hljs-string">&quot;memberID&quot;</span>)<br>	result := db.Model(&amp;Member&#123;&#125;).Where(<span class="hljs-string">&quot;id = ?&quot;</span>, memberID).Update(<span class="hljs-string">&quot;username&quot;</span>, <span class="hljs-string">&quot;Bob&quot;</span>)<br>	<span class="hljs-keyword">if</span> err := result.Error; err != <span class="hljs-literal">nil</span> &#123;<br>		c.JSON(http.StatusForbidden, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: err.Error()&#125;)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	c.JSON(http.StatusOK, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;update success&quot;</span>&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>updates - 更新多个字段</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">result := db.Model(&amp;Member&#123;&#125;).Where(<span class="hljs-string">&quot;id = ?&quot;</span>, memberID).Updates(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>&#123;&#125;&#123;<span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123456&quot;</span>&#125;)<br></code></pre></td></tr></table></figure>

<ul>
<li>save - 保存所有字段</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">updateMemberInfo</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	memberID := c.Param(<span class="hljs-string">&quot;memberID&quot;</span>)<br>	<span class="hljs-keyword">var</span> m Member<br>	<span class="hljs-keyword">if</span> db.Model(&amp;Member&#123;&#125;).First(&amp;m, memberID).RowsAffected == <span class="hljs-number">0</span> &#123;<br>		c.JSON(http.StatusForbidden, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;没有找到用户信息&quot;</span>&#125;)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	m.Username = <span class="hljs-string">&quot;Bob&quot;</span><br>  <span class="hljs-comment">// 注意：如果m为零值，这里save会变成insert操作，所以前面必须加上逻辑判断是否找到用户</span><br>	<span class="hljs-keyword">if</span> err := db.Save(&amp;m).Error; err != <span class="hljs-literal">nil</span>&#123;<br>		c.JSON(http.StatusForbidden, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: err.Error()&#125;)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	c.JSON(http.StatusOK, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;update success&quot;</span>, <span class="hljs-string">&quot;member&quot;</span>: m&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>



<h5 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">deleteMember</span><span class="hljs-params">(c *gin.Context)</span></span>&#123;<br>	memberID := c.Param(<span class="hljs-string">&quot;memberID&quot;</span>)<br>	db.Where(<span class="hljs-string">&quot;id=?&quot;</span>, memberID).Delete(&amp;Member&#123;&#125;)<br>  <span class="hljs-comment">// db.Delete(&amp;Member&#123;&#125;, memberID)   根据主键删除</span><br>	c.JSON(http.StatusOK, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;delete success&quot;</span>&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>



<h4 id="原生SQL"><a href="#原生SQL" class="headerlink" title="原生SQL"></a>原生SQL</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">singleMemberInfo</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	memberID := c.Param(<span class="hljs-string">&quot;memberID&quot;</span>)<br>	<span class="hljs-keyword">var</span> member entity.MemberInfo<br>	db.Raw(<span class="hljs-string">&quot;select * from member where id = ?&quot;</span>, memberID).Find(&amp;member)<br>	c.JSON(http.StatusOK, gin.H&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;success&quot;</span>, <span class="hljs-string">&quot;member&quot;</span>: member&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>




<h4 id="开启事务"><a href="#开启事务" class="headerlink" title="开启事务"></a>开启事务</h4><ul>
<li>自动事务</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go">db.Transaction(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tx *gorm.DB)</span> <span class="hljs-title">error</span></span> &#123;<br>	<span class="hljs-keyword">if</span> err := tx.Create(&amp;member).Error; err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-comment">// 返回任何错误都会回滚事务</span><br>		<span class="hljs-keyword">return</span> err<br>	&#125;<br>	<span class="hljs-comment">// 返回 nil 提交事务</span><br>	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<ul>
<li>手动事务</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go">tx := db.Begin()<br>tx.Create(&amp;member)<br>tx.Commit()<br> <span class="hljs-comment">// 出现异常手动执行	tx.Rollback()</span><br></code></pre></td></tr></table></figure>



<h4 id="Special-function"><a href="#Special-function" class="headerlink" title="Special function"></a>Special function</h4><h5 id="Find-和-Scan"><a href="#Find-和-Scan" class="headerlink" title="Find 和 Scan"></a>Find 和 Scan</h5><p><code>Find</code> 和 <code>Scan</code> 都是将查询的数据反序列化到对象中，使用情况基本相同</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">db.Model(&amp;Member&#123;&#125;).Where(<span class="hljs-string">&quot;id = ?&quot;</span>, memberID).Find(&amp;member)<br>db.Table(<span class="hljs-string">&quot;member&quot;</span>).Where(<span class="hljs-string">&quot;id = ?&quot;</span>, memberID).Scan(&amp;member)<br></code></pre></td></tr></table></figure>

<blockquote>
<p><code>Find</code> 和 <code>Scan</code> 可以互换</p>
</blockquote>
<h5 id="Raw-和-Exec"><a href="#Raw-和-Exec" class="headerlink" title="Raw 和 Exec"></a>Raw 和 Exec</h5><p><code>Raw</code> 和 <code>Exec</code> 都可以接收原生SQL执行，<code>Raw</code>适合执行需要接收返回值的语句，<code>Exec</code>适合执行不需要返回值的语句</p>
<ul>
<li>Raw</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">db.<span class="hljs-constructor">Raw(<span class="hljs-string">&quot;select * from member where id = ?&quot;</span>, <span class="hljs-params">memberID</span>)</span>.<span class="hljs-constructor">Scan(&amp;<span class="hljs-params">member</span>)</span><br></code></pre></td></tr></table></figure>

<ul>
<li>Exec</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">db.Exec(<span class="hljs-string">&quot;update member set password=&#x27;123456&#x27;&quot;</span>)<br></code></pre></td></tr></table></figure>



<h4 id="钩子函数"><a href="#钩子函数" class="headerlink" title="钩子函数"></a>钩子函数</h4><p><a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/hooks.html">钩子函数(Hook)</a> 是在创建、查询、更新、删除等操作之前、之后调用的函数。</p>
<p>如果您已经为模型定义了指定的方法，它会在创建、更新、查询、删除时自动被调用。如果任何回调返回错误，GORM 将停止后续的操作并回滚事务。</p>
<p>钩子方法的函数签名应该是 <code>func(*gorm.DB) error</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span> <span class="hljs-title">AfterCreate</span><span class="hljs-params">(tx *gorm.DB)</span> <span class="hljs-params">(err error)</span></span> &#123;<br>  <span class="hljs-keyword">if</span> u.ID == <span class="hljs-number">1</span> &#123;<br>    tx.Model(u).Update(<span class="hljs-string">&quot;role&quot;</span>, <span class="hljs-string">&quot;admin&quot;</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span> <span class="hljs-title">AfterUpdate</span><span class="hljs-params">(tx *gorm.DB)</span> <span class="hljs-params">(err error)</span></span> &#123;<br>  <span class="hljs-keyword">if</span> u.Confirmed &#123;<br>    tx.Model(&amp;Address&#123;&#125;).Where(<span class="hljs-string">&quot;user_id = ?&quot;</span>, u.ID).Update(<span class="hljs-string">&quot;verfied&quot;</span>, <span class="hljs-literal">true</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span> <span class="hljs-title">AfterDelete</span><span class="hljs-params">(tx *gorm.DB)</span> <span class="hljs-params">(err error)</span></span> &#123;<br>  <span class="hljs-keyword">if</span> u.Confirmed &#123;<br>    tx.Model(&amp;Address&#123;&#125;).Where(<span class="hljs-string">&quot;user_id = ?&quot;</span>, u.ID).Update(<span class="hljs-string">&quot;invalid&quot;</span>, <span class="hljs-literal">false</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span><br>&#125;<br></code></pre></td></tr></table></figure>



<h4 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h4><ul>
<li><a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/models.html">gorm中文官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/models.html#%E5%AD%97%E6%AE%B5%E6%A0%87%E7%AD%BE">gorm标签</a></li>
<li><a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/go-playground/validator/v10#pkg-overview">go-playground/validator</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42279809/article/details/107800081">gin框架参数零值json绑定的问题</a></li>
<li><a target="_blank" rel="noopener" href="http://foreversmart.cc/go/the-difference-of-gorm-scan-and-find/">Gorm 中 Scan 和 Find 的区别</a></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/Myblog/categories/Go/">Go</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/Myblog/tags/gorm/">gorm</a>
                    
                      <a class="hover-with-bg" href="/Myblog/tags/orm/">orm</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/Myblog/2021/08/27/GoLang%E5%AE%9E%E7%94%A8%E5%8A%9F%E8%83%BD/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">GoLang实用功能</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/Myblog/2021/08/18/shell%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
                        <span class="hidden-mobile">shell常用命令</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                

              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/Myblog/js/events.js" ></script>
<script  src="/Myblog/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/Myblog/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>






  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/Myblog/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/Myblog/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/Myblog/js/boot.js" ></script>


</body>
</html>
